package co.edu.uco.ucobet.generales.domain.city.rules.impl;

import co.edu.uco.ucobet.generales.application.secondaryports.repository.CityRepository;
import co.edu.uco.ucobet.generales.domain.city.rules.CityNameForStateDoesNotExistRule;

public class CityNameForStateDoesNotExistRuleImpl implements CityNameForStateDoesNotExistRule{
	
	private final CityRepository cityRepository;

	public CityNameForStateDoesNotExistRuleImpl(CityRepository cityRepository) {
		this.cityRepository = cityRepository;
	}

	@Override
	public void validate(String cityName, UUID stateId) {
		// Crea un filtro para buscar ciudades que coincidan con el nombre y el estado
		CityEntity filter = new CityEntity();
		filter.setName(cityName);
		filter.getState().setId(stateId); // Supone que tienes un m√©todo para establecer el estado en CityEntity

		// Verifica si hay alguna ciudad que coincida con el filtro
		List<CityEntity> cities = cityRepository.findByFilter(filter);

		if (!cities.isEmpty()) {
			throw CityNameForStateAlreadyExistsException.create(cityName, stateId);
		}
	}
}
