package co.edu.uco.ucobet.generales.domain.city.rules.impl;

import java.util.List;
import java.util.UUID;

import co.edu.uco.ucobet.generales.application.secondaryports.entity.CityEntity;
import co.edu.uco.ucobet.generales.application.secondaryports.repository.CityRepository;
import co.edu.uco.ucobet.generales.domain.city.CityDomain;
import co.edu.uco.ucobet.generales.domain.city.exceptions.CityNameForStateDoesExistException;
import co.edu.uco.ucobet.generales.domain.city.rules.CityNameForStateDoesNotExistRule;

public class CityNameForStateDoesNotExistRuleImpl implements CityNameForStateDoesNotExistRule {

	private final CityRepository cityRepository;

	public CityNameForStateDoesNotExistRuleImpl(CityRepository cityRepository) {
		this.cityRepository = cityRepository;
	}

	@Override
	public void validate(String cityName, UUID stateId) {
		CityEntity filter = new CityEntity();
		filter.setName(cityName);
		filter.getState().setId(stateId);

		List<CityEntity> cities = cityRepository.findByFilter(filter);

		if (!cities.isEmpty()) {
			throw CityNameForStateDoesExistException.create(cityName, stateId);
		}
	}

	
}
